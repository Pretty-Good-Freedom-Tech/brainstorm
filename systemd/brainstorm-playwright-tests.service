[Unit]
Description=Brainstorm Playwright Tests
After=network.target brainstorm-control-panel.service

[Service]
Type=oneshot
User=brainstorm
Group=brainstorm
WorkingDirectory=/usr/local/lib/node_modules/brainstorm
Environment=NODE_ENV=production
Environment=BRAINSTORM_BASE_URL=http://localhost:7778
Environment=BRAINSTORM_LOG_DIR=/var/log/brainstorm
ExecStart=/usr/bin/node bin/test-deployment.js smoke
StandardOutput=append:/var/log/brainstorm/playwright-tests.log
StandardError=append:/var/log/brainstorm/playwright-tests.log

# Security settings
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/var/log/brainstorm /tmp

[Install]
WantedBy=multi-user.target
